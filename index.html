<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Skala Entertainment | Homepage</title>
        <link rel="icon" type="image/png" href="favicon.png">
        <link rel="stylesheet" href="assets/style.css">
    </head>

    <body>
      <div class="entrance" id="baklawaveContainer">
          <svg class="logo" aria-label="Welcome to Skala Entertainment homepage" viewBox="0 -10 400.844 110.145">
              <path id="logo-skala-s1" d="M33.887 0 17.624 16.246 1.36 32.492l.092.092.091.092 15.963-.07 15.964-.071 16.073-16.068L65.617.398V0H49.752z"/>
              <path id="logo-skala-s2" d="m65.403 33.47-15.915.132-15.914.132-16.126 16.122-16.125 16.12V66.147H33.25L49.416 49.95 65.58 33.757l-.088-.144z"/>
              <path id="logo-skala-k1" d="m117.578 0-.779.598-.78.598-15.647 15.658-15.649 15.658.082.082.082.082 15.956-.06 15.957-.06 16.08-16.078L148.96.398V0h-15.69Z"/>
              <path id="logo-skala-k2" d="m84.852 33.593-.083.084-.083.082 16.2 16.194 16.202 16.193h31.872v-.399L132.882 49.67l-16.078-16.076h-15.976Z"/>
              <path id="logo-skala-a1" d="M199.76.928v32.284l-16.08 16.07-16.082 16.07h-.381V33.468l16.272-16.27Z"/>
              <path id="logo-skala-a2" d="m200.554 1.014.283.094.284.095 16.118 16.1 16.118 16.1-.006 15.842-.006 15.843-.321-.021-.323-.02-16.073-16.096-16.074-16.097v-15.92Z"/>
              <path id="logo-skala-l1" d="M282.973 1.058h.396v31.884l-16.272 16.27-16.272 16.27V33.204l16.074-16.072zm.808 32.544h16.132l16.132.001-16.277 16.271-16.276 16.272h-31.578l-.133-.216-.133-.217 16.066-16.055z"/>
              <path id="logo-skala-l2" d="m283.781 33.602-16.067 16.056-16.066 16.055.133.217.134.216H283.492l16.276-16.272 16.277-16.27-16.132-.001z"/>
              <path id="logo-skala-aa1" d="M366.317 1.058h.396v31.884l-16.272 16.27-16.272 16.27V33.204l16.074-16.072z"/>
              <path id="logo-skala-aa2" d="m367.506.662 16.274 16.274 16.274 16.274-.068 16.072-.068 16.072-16.206-16.208-16.206-16.207V16.801Z"/>
              <path id="logo-entertainment-e" d="M0 82.815v17.154l.264.087.263.089 8.005-.065 8.004-.065.347-.001.346-.001-.163-.265-.164-.264H.515l.073-3.864.073-3.863 4.062.04 4.06.038-.113-.343-.114-.343-4.014-.073-4.013-.073V83.344h16.669v-.529H8.599z"/>
              <path id="logo-entertainment-n" d="m50.063 82.815-.16.418-.161.419-.001 7.717-.002 7.717-8.113-8.124-8.114-8.123-.22.136-.22.135v16.903h.795V83.935l8.043 8.039 8.043 8.039h.582V82.815H50.3z"/>
              <path id="logo-entertainment-t" d="M66.675 82.815v.515l4.035.073 4.035.073.07 8.268.07 8.269h.514l.07-8.269.07-8.268 4.167-.073 4.167-.073v-.515h-8.599z"/>
              <path id="logo-entertainment-ee" d="m100.342 82.815-.301.362-.3.363.07 8.17.07 8.17 7.937.133 7.937.132.599-.01.598-.01-.07-.255-.068-.254h-16.272v-7.938l4.127.08 4.128.079-.115-.344-.115-.344h-8.026v-7.805h16.669v-.529h-8.434z"/>
              <path id="logo-entertainment-r" d="m133.72 82.815-.317.317-.318.318v16.21l.177.176.176.177h.441v-8.335l4.04.079 4.04.078 4.061 4.089 4.061 4.089h.574l-1.046-1.09-1.045-1.09-2.971-2.945-2.97-2.945 3.896-.133 3.897-.132.072-4.432.073-4.431h-8.42zm.16.529h15.874v7.805H133.88v-3.903z"/>
              <path id="logo-entertainment-tt" d="m166.984 82.815-.164.264-.164.265.479.013.479.013 3.638-.026 3.638-.025v16.694h.814l-.033-8.269-.032-8.268 4.124-.073 4.122-.073v-.515h-8.45z"/>
              <path id="logo-entertainment-a" d="m208.452 82.815-4.213 4.27-4.214 4.27v8.658h.529V91.81h16.14V99.715l.264.164.265.164V91.31l-2.53-2.549-.137.05-.131-.03.037.164-.004.086h.119V88.9h.132l.362.246-2.059-2.083-4.21-4.248h-.175zm-.111 1.058.274.003.274.003 3.505 3.422 3.506 3.421v.295h-14.646l3.543-3.571z"/>
              <path id="logo-entertainment-i" d="M233.363 82.815v17.198h.529V82.815h-.265z"/>
              <path id="logo-entertainment-nn" d="M250.031 82.815v17.198h.529v-15.58l.22-.135.219-.136 7.955 7.958 7.955 7.958.227-.14.225-.14-.073-8.491-.073-8.492h-.507l-.07 8.089-.07 8.088-8.07-8.087-8.07-8.088-.198-.001z"/>
              <path id="logo-entertainment-m" d="M283.369 82.815v17.241l.33-.11.33-.11.061-7.519.06-7.518.007-.394.006-.393 3.968 3.962 3.97 3.962 3.964-3.958 3.964-3.958.07 7.93.071 7.93h.529l.07-8.533.07-8.532h-.532l-4.146 4.12-4.147 4.121-4.127-4.12-4.127-4.121h-.196z"/>
              <path id="logo-entertainment-eee" d="m334.169 82.807-8.665.07-8.665.07-.07 8.533-.07 8.533h17.576l-.273-.273-.272-.272-8.115.074-8.115.074V91.77l3.968-.046 3.968-.047v-.529H317.5V83.324l.596.05.596.052 7.739-.041 7.739-.041v-.268z"/>
              <path id="logo-entertainment-nnn" d="m367.034 82.815-.16.418-.161.419V99.08l-3.018-3.137-4.802-4.932 1.574 1.93-1.412-.99 7.856 8.06h.595V82.815h-.236zm-16.42-.053-.345.21-.225.138.12 8.206-.12 8.344.176.176.177.177h.44l.12-8.106V83.87l4.213 4.21.257-.145.549.099-2.908-2.928zm5.085 4.992-.295.183-.236.145 3.826 3.825 2.156 2.166-.759-1.03 1.51 1.077-3.811-3.95-1.312-1.325-.014-.014z"/>
              <path id="logo-entertainment-ttt" d="M383.646 82.815v.515l4.035.073 4.035.073.07 8.268.07 8.269h.514l.07-8.269.07-8.268 4.167-.073 4.167-.073v-.515h-8.6z"/>
          </svg>
      </div>

      <svg id="baklava-symbols">
          <symbol id="baklava-1" viewBox="0 0 64.295 32.595">
              <path style="fill: currentColor" d="M48.303.051 32.402.183l-12.765 12.76C12.616 19.96 5.326 27.253 3.436 29.148L0 32.595h32.034L48.21 16.402C57.105 7.496 64.344.144 64.294.064c-.05-.08-7.245-.086-15.991-.013z"/>

          </symbol>
          <symbol id="baklava-2" viewBox="0 0 32.544 64.424">
              <path style="fill: currentColor" d="M32.544 0 16.272 16.27 0 32.54v15.942c0 8.768.074 15.942.165 15.942.09 0 7.413-7.233 16.271-16.073l16.107-16.073v-16.14z"/>
          </symbol>
          <symbol id="baklava-3" viewBox="0 0 32.803 63.981">
              <path style="fill: currentColor" d="M.277 0C.086-.062 0 4.832 0 15.807v15.9l16.167 16.137c8.892 8.876 16.27 16.138 16.395 16.138.127 0 .232-7.087.235-15.822l.006-15.822-16.124-16.122C7.81 7.348.43.052.277 0Z"/>
          </symbol>
          <symbol id="baklava-4" viewBox="0 0 64.192 32.553">
              <path style="fill: currentColor" d="M16.06 0C7.271 0 .045.037 0 .083c-.045.045 7.208 7.37 16.119 16.276l16.2 16.194h15.937c8.764 0 15.936-.09 15.936-.2 0-.11-7.235-7.434-16.078-16.276L32.035.001Z"/>
          </symbol>
      </svg>

      <script type="module">
          import * as THREE from './assets/three.module.min.js';

          import { Pane } from './assets/tweakpane.min.js';

const storedConfig = localStorage.getItem('config')

const defaultConfig = {
  baklavaWidth: 16,
  baklavaHeight: 16,
  skewFactor: 1,
  columns: 80,
  rows: 80,
  color: {
    // 0x6686c6,
    r: 102,
    g: 134,
    b: 198
  },
  waveSpeed: 0.001,
  waveAmpX: 0.15,
  waveAmpY: 0.1,
  waveFreqX: 3,
  waveFreqY: 2.4,
  angleX: -40,
  angleZ: 140,
  cameraFOV: 25,
  cameraX: 0,
  cameraY: 0,
  cameraZ: 10
}

const config = storedConfig ? JSON.parse(storedConfig) : {
    ...defaultConfig,
    color: {
        ...defaultConfig.color
    }
}

const ctrl = new Pane({
  title: 'baklava ayarlarÄ±',
  expanded: config.isDefault,
})

ctrl.addBinding(config, 'baklavaWidth', {
  min: 1,
  max: 100,
  step: 1,
  label: 'baklava en',
})

ctrl.addBinding(config, 'baklavaHeight', {
  min: 1,
  max: 100,
  step: 1,
  label: 'baklava boy',
})

ctrl.addBinding(config, 'skewFactor', {
  min: 0,
  max: 5,
  step: 0.1,
  label: 'baklava basiklik',
})

ctrl.addBinding(config, 'columns', {
  min: 1,
  max: 500,
  step: 1,
  label: 'alt alta adet',
})

ctrl.addBinding(config, 'rows', {
  min: 1,
  max: 500,
  step: 1,
  label: 'yan yana adet',
})

ctrl.addBinding(config, 'color', {
  min: 1,
  max: 500,
  step: 1,
  label: 'renk',
})

ctrl.addBinding(config, 'waveSpeed', {
  min: 0.0001,
  max: 0.03,
  step: 0.00001,
  label: 'hiz',
})

ctrl.addBinding(config, 'waveAmpX', {
  min: 0,
  max: 1,
  step: 0.01,
  label: 'yatay dalga boyu',
})

ctrl.addBinding(config, 'waveAmpY', {
  min: 0,
  max: 1,
  step: 0.01,
  label: 'dikey dalga boyu',
})

ctrl.addBinding(config, 'waveFreqX', {
  min: 0,
  max: 31.415,
  step: 0.1,
  label: 'yatay dalga frekans',
})

ctrl.addBinding(config, 'waveFreqY', {
  min: 0,
  max: 31.415,
  step: 0.1,
  label: 'dikey dalga frekans',
})

ctrl.addBinding(config, 'angleX', {
  min: -180,
  max: 180,
  step: 0.1,
  label: 'X ekseninde cevir',
})

ctrl.addBinding(config, 'angleZ', {
  min: -180,
  max: 180,
  step: 0.1,
  label: 'Z ekseninde cevir',
})

ctrl.addBinding(config, 'cameraX', {
  min: -100,
  max: 40,
  step: 0.01,
  label: 'Kamera Pan X',
})

ctrl.addBinding(config, 'cameraY', {
  min: -100,
  max: 40,
  step: 0.01,
  label: 'Kamera Pan Y',
})

ctrl.addBinding(config, 'cameraFOV', {
  min: 1,
  max: 180,
  step: 0.1,
  label: 'Kamera FoV',
})

ctrl.addBinding(config, 'cameraZ', {
  min: 0,
  max: 100,
  step: 0.01,
  label: 'Kamera Z',
})

function syncBaklava() {
  deleteLines()
  const newLines = createLines()
  wireframe = newLines.wireframe
  lineGeometry = newLines.lineGeometry
  scene.add(wireframe)
}

function syncRotateX() {
  wireframe.rotation.x = Math.PI / 180 * config.angleX
}

function syncRotateZ() {
  wireframe.rotation.z = Math.PI / 180 * config.angleZ
}

function syncCameraPanX() {
  camera.position.x = config.cameraX
  camera.updateProjectionMatrix()
}

function syncCameraPanY() {
  camera.position.y = config.cameraY
  camera.updateProjectionMatrix()
}

function syncCameraZ() {
  camera.position.z = config.cameraZ
  camera.updateProjectionMatrix()
}

function syncCameraFOV() {
  camera.fov = config.cameraFOV
  camera.updateProjectionMatrix()
}

function saveLocalStorage() {
  localStorage.setItem('config', JSON.stringify(config))
}

function sync(event) {
  if (event.all) {
    syncBaklava()
    syncRotateX()
    syncRotateZ()
    syncCameraPanX()
    syncCameraPanY()
    syncCameraZ()
    syncCameraFOV()
    return
  }
  switch (event.target.controller.view.labelElement.innerText) {
    case 'baklava en':
    case 'baklava boy':
    case 'baklava basiklik':
    case 'yan yana adet':
    case 'alt alta adet':
    case 'renk':
      syncBaklava()
      break
    case 'X ekseninde cevir':
      syncRotateX()
      break
    case 'Z ekseninde cevir':
      syncRotateZ()
      break
    case 'Kamera Pan X':
      syncCameraPanX()
      break
    case 'Kamera Pan Y':
      syncCameraPanY()
      break
    case 'Kamera Z':
      syncCameraZ()
      break
    case 'Kamera FoV':
      syncCameraFOV()
      break
  }
  config.isDefault = false
  saveLocalStorage()
}

const resetButton = ctrl.addButton({
  title: 'Reset',
  label: 'Fabrika ayarlari'
})

const exportButton = ctrl.addButton({
  title: 'Export'
})

exportButton.on('click', () => {
alert(JSON.stringify(config, null, 2))
})

resetButton.on('click', () => {
    for (let key in defaultConfig) {
        if (defaultConfig.hasOwnProperty(key)) {
            if (typeof defaultConfig[key] === 'object') {
                config[key] = {
                    ...defaultConfig[key]
                }
            } else {
                config[key] = defaultConfig[key]
            }
        }
    }
    sync({ all: true })
    ctrl.refresh()
    config.isDefault = true
    saveLocalStorage()
})

ctrl.on('change', sync)

// Scene setup
const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(
  config.cameraFOV,
  window.innerWidth / window.innerHeight,
  0.1, 1000
);
camera.position.set(
  config.cameraX,
  config.cameraY,
  config.cameraZ,
);

const renderer = new THREE.WebGLRenderer({ antialias: true });
renderer.setSize(window.innerWidth, window.innerHeight);
baklawaveContainer.insertAdjacentElement('afterBegin', renderer.domElement);
renderer.domElement.id = 'baklawave'

function createLines() {
  // Generate parallelogram-shaped quads manually
  const vertices = [];
  const edges = [];

  // Create quads with skewed positions (parallelograms)
  for (let i = 0; i <= config.rows; i++) {
              for (let j = 0; j <= config.columns; j++) {
              const x = (j / config.columns - 0.5) * config.baklavaWidth;
              const y = (i / config.rows - 0.5) * config.baklavaHeight;
              const skewX = y * config.skewFactor; // Skew applied based on Y
              vertices.push(x + skewX, y, 0);
              }
              }

              // Connect vertices into wireframe edges (manual parallelogram outline)
              for (let i = 0; i < config.rows; i++) {
              for (let j = 0; j < config.columns; j++) {
              const index = i * (config.columns + 1) + j;
              const nextRowIndex = (i + 1) * (config.columns + 1) + j;

              // Connect edges for parallelogram structure (without diagonals)
              edges.push(index, index + 1); // Horizontal edge
              edges.push(index, nextRowIndex); // Vertical edge
              }
              }

              // Create geometry for custom wireframe
              const lineGeometry = new THREE.BufferGeometry();
              lineGeometry.setAttribute('position', new THREE.Float32BufferAttribute(vertices, 3));
              lineGeometry.setIndex(edges);
              const lineMaterial = new THREE.LineBasicMaterial({
              color: `rgb(${~~config.color.r}, ${~~config.color.g}, ${~~config.color.b})`
              });
              const wireframe = new THREE.LineSegments(lineGeometry, lineMaterial);
              wireframe.rotation.x = Math.PI / 180 * config.angleX
              wireframe.rotation.z = Math.PI / 180 * config.angleZ

              return {
              lineGeometry,
              wireframe
              }
              }

              function deleteLines() {
              scene.remove(wireframe);
              if (wireframe.geometry) wireframe.geometry.dispose();
              if (wireframe.material) {
              if (Array.isArray(wireframe.material)) {
              wireframe.material.forEach(mat => mat.dispose());
    } else {
      wireframe.material.dispose();
    }
  }
}

let { lineGeometry, wireframe } = createLines()
scene.add(wireframe)

// Animate the waving effect
function animateWave() {
    const time = Date.now() * config.waveSpeed;
    const position = lineGeometry.attributes.position;

    for (let i = 0; i < position.count; i++) {
              const x = position.getX(i);
              const y = position.getY(i);
              const z = (
              Math.sin(x * config.waveFreqX + time) * config.waveAmpX +
              Math.cos(y * config.waveFreqY + time) * config.waveAmpY
              );
              position.setZ(i, z);
              }

              lineGeometry.attributes.position.needsUpdate = true;
              }

              // Animation loop
              function animate() {
              requestAnimationFrame(animate);
              animateWave();
              renderer.render(scene, camera);
              }

              animate();
      </script>
    </body>

</html>
